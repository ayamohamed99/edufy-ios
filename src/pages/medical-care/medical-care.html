<ion-header>
<ion-navbar color="primary">
  <ion-buttons left style="width: 30px;">
    <button ion-button icon-only menuToggle>
      <ion-icon name="menu"></ion-icon>
    </button>
  </ion-buttons>
  <ion-title text-center>MedicalCare</ion-title>
  <ion-buttons right>
    <button ion-button [disabled]="true">
    </button>
  </ion-buttons>
</ion-navbar>
  <ion-toolbar class="toolBarShap" color="primary" *ngIf="!platform.is('ios')">
    <ion-segment [(ngModel)]="View" color="light">
      <ion-segment-button style="min-width: fit-content; padding-left: 6px;padding-right: 6px" [value]="MEDICATIONS_NAME" (click)="tabThatSelectedDo(MEDICATIONS_NAME)" *ngIf="accountServ.getUserRole().viewMedication">{{MEDICATION_TAB}}</ion-segment-button>
      <ion-segment-button style="min-width: fit-content; padding-left: 6px;padding-right: 6px" [value]="INCIDENTS_NAME" (click)="tabThatSelectedDo(INCIDENTS_NAME)" *ngIf="accountServ.getUserRole().viewIncident">{{INCIDENT_TAB}}</ion-segment-button>
      <ion-segment-button style="min-width: fit-content; padding-left: 6px;padding-right: 6px" [value]="CHECKUPS_NAME" (click)="tabThatSelectedDo(CHECKUPS_NAME)" *ngIf="accountServ.getUserRole().viewCheckup">{{CHECKUP_TAB}}</ion-segment-button>
      <ion-segment-button style="min-width: fit-content; padding-left: 6px;padding-right: 6px" [value]="WAITING_APPROVAL_NAME" (click)="tabThatSelectedDo(WAITING_APPROVAL_NAME)" *ngIf="accountServ.getUserRole().medicalRecordCanApprove">{{APPROVING_TAB}}</ion-segment-button>
    </ion-segment>
  </ion-toolbar>
  <ion-toolbar  class="toolBarShap" color="gray" *ngIf="platform.is('ios')">
    <ion-segment [(ngModel)]="View" color="primary" style="padding-top: 5px;padding-right: 5px;padding-left: 5px" *ngIf="platform.is('ios')">
      <ion-segment-button style="min-width: fit-content; padding-left: 6px;padding-right: 6px" [value]="MEDICATIONS_NAME" (click)="tabThatSelectedDo(MEDICATIONS_NAME)" *ngIf="accountServ.getUserRole().viewMedication">{{MEDICATION_TAB}}</ion-segment-button>
      <ion-segment-button style="min-width: fit-content; padding-left: 6px;padding-right: 6px" [value]="INCIDENTS_NAME" (click)="tabThatSelectedDo(INCIDENTS_NAME)" *ngIf="accountServ.getUserRole().viewIncident">{{INCIDENT_TAB}}</ion-segment-button>
      <ion-segment-button style="min-width: fit-content; padding-left: 6px;padding-right: 6px" [value]="CHECKUPS_NAME" (click)="tabThatSelectedDo(CHECKUPS_NAME)" *ngIf="accountServ.getUserRole().viewCheckup">{{CHECKUP_TAB}}</ion-segment-button>
      <ion-segment-button style="min-width: fit-content; padding-left: 6px;padding-right: 6px" [value]="WAITING_APPROVAL_NAME" (click)="tabThatSelectedDo(WAITING_APPROVAL_NAME)" *ngIf="accountServ.getUserRole().medicalRecordCanApprove">{{APPROVING_TAB}}</ion-segment-button>
    </ion-segment>
  </ion-toolbar>
</ion-header>


<ion-content padding class="contentColor">



  <ion-slides style="height: 100%;" (ionSlideDidChange)="slideChanged()">


    <!--MEDICATIOM-->
    <ion-slide style="height: 100%;width: 100%;" *ngIf="accountServ.getUserRole().viewMedication">
      <ion-content class="contentScroll">

        <!--SCROLL TO REFRESH-->
        <ion-refresher (ionRefresh)="doRefresh($event)">
          <ion-refresher-content></ion-refresher-content>
        </ion-refresher>

        <div *ngIf="loading && medicalRecords.length < 1">
          <img class="loadingMedicalCare" src="assets/imgs/heartbeat.svg">
        </div>

        <ion-item class="fitTheView" >
          <ion-label class="textColor">Status</ion-label>
          <ion-select [(ngModel)]="theStatus" (ngModelChange)="statusModelChange(true)" interface="popover" [disabled]="loading && medicalRecords.length < 1">
            <ion-option [selected]="theStatus" *ngFor="let status of allStatusInMedication" >{{status}}</ion-option>
          </ion-select>
        </ion-item>

        <ion-grid>
          <ion-row>
            <ion-col *ngFor="let medicine of medicalRecords;let k = index" col-12 col-sm-12 col-xl-4 col-lg-6 col-md-6>
              <!--START THE CARD-->

              <div class="editDivView">
                <!--<ion-card class="scale-up-center" *ngIf="checkMedicationTime(time.time,medicine.oneMedication) && !checkIfTaken(time.medicationsNotifications)">-->
                <ion-card class="scale-up-center">

                  <ion-item mode="md">

                    <ion-avatar item-start>
                      <img src="assets/imgs/profile.png" *ngIf="!medicine.student.profileImg">
                      <img [src]="medicine.student.profileImg" *ngIf="medicine.student.profileImg">
                    </ion-avatar>

                    <label class="studentName" text-capitalize>{{ medicine.student.name}}</label>
                    <label class="studentClass" text-capitalize>{{medicine.student.classes.grade.name+" - "+medicine.student.classes.name}}</label>
                    <label class="creationDate" text-capitalize>{{ medicine.oneMedication.creationDate}}</label>


                    <div class="buttonOnImg">
                      <button ion-button class="closeInDiv" clear icon-only *ngIf="false" item-end (click)="openMenu($event)">
                        <!--<button ion-button class="closeInDiv" clear icon-only *ngIf="medicine.createdFrom == 'web'" item-end (click)="openMenu($event)">-->
                        <ion-icon style="background: #eee0;color: #000000;" name="md-more" class="buttonShape" ></ion-icon>
                      </button>
                    </div>
                  </ion-item>

                  <label class="studentMedication">{{medicine.oneMedication.medicine.name}}</label>

                  <div class="dosagePart">

                    <img class="imgDosage" src="assets/icon/times.png"/>
                    <label class="dosageTimes">Times of Dosages</label>

                  </div>


                  <div class="dosagePartForButton">
                    <div class="imgSpaceButton"></div>
                    <div class="buttonDiv">
                      <label class="timesColor">{{optimizeTimesData(medicine.oneMedication.medicationSchedule)}}</label>
                    </div>
                  </div>


                  <span *ngIf="medicine.activeMedication && !medicine.activeMedicationTaken">
            <div class="dosagePart">
              <img class="imgDosage" src="assets/icon/warning.png"/>
              <label class="dosageTimes">Instructions</label>
            </div>


            <div class="dosagePartForButton">
              <div class="imgSpaceButton"></div>
              <div class="buttonDiv">
                <label class="timesColor">{{optimizeInstructionData(medicine.oneMedication.instructions)}}</label>
              </div>
            </div>
          </span>

                  <span *ngIf="(medicine.activeMedication && medicine.activeMedicationTaken) || !medicine.activeMedication">
            <div class="dosagePart">
              <img class="imgDosage" src="assets/icon/calendar.png"/>
              <label class="dosageTimes">Days</label>
            </div>

            <div class="dosagePartForButton">
              <div class="imgSpaceButton"></div>
              <div class="buttonDiv">
                <label class="timesColor">{{setDaysOfMedication(medicine.oneMedication.medicationSchedule[0])}}</label>
              </div>
            </div>
          </span>

                  <span *ngIf="!medicine.activeMedication && !medicine.activeMedicationTaken">
            <div class="dosagePart">
              <img class="imgDosage" src="assets/icon/sand-clock.png"/>
              <div class="separatImg">
                <label class="dosageNumber">From</label>
                <label class="dosageType">To</label>
              </div>
            </div>

            <div class="dosagePartWithoutMargin">
              <div class="imgSpace"></div>
              <div class="separatValue">
                <label class="dosageNumberValue">{{setStartAndEndDate(medicine.oneMedication.startDate,'start')}}</label>
                <img class="imgDosage" src="assets/icon/FromToArrow.png"/>
                <label class="dosageTypeValue">{{setStartAndEndDate(medicine.oneMedication.endDate,'end')}}</label>
              </div>
            </div>
          </span>

                  <div class="buttonActionTime" [ngClass]="medicine.activeMedicationTaken?'buttonActionTimeConfirm':'buttonActionTime'" *ngIf="(medicine.activeMedication && medicine.activeMedicationTaken) || ( medicine.activeMedication && !medicine.activeMedicationTaken)">
                    <button mode="ios" class="buttonTime" [ngClass]="medicine.activeMedicationTaken?'confirmTime':'buttonTime'" [id]="'timeButton'+k" ion-button block  (click)="confirmTime($event,'timeButton'+k,medicine.timeOfActiveMedication.id,checkIfTaken(medicine.timeOfActiveMedication.medicationsNotifications))">
                      {{writeOnTimeButton(medicine)}}
                    </button>
                  </div>

                  <div class="bottomSpace"></div>
                </ion-card>
              </div>

            </ion-col>
          </ion-row>
        </ion-grid>

        <!--SCROLL TO ADD MORE-->
        <ion-infinite-scroll (ionInfinite)="$event.waitFor(doInfinite())">
          <ion-infinite-scroll-content></ion-infinite-scroll-content>
        </ion-infinite-scroll>

      </ion-content>
    </ion-slide>



























    <!--INCIDENT-->
    <ion-slide style="height: 100%;width: 100%;" *ngIf="accountServ.getUserRole().viewIncident">
      <ion-content class="contentScroll">

        <!--SCROLL TO REFRESH-->
        <ion-refresher (ionRefresh)="doRefresh($event)">
          <ion-refresher-content></ion-refresher-content>
        </ion-refresher>


        <div *ngIf="loading && incidentRecords.length < 1">
          <img class="loadingMedicalCare" src="assets/imgs/heartbeat.svg">
        </div>

        <ion-item class="fitTheView" >

        </ion-item>

        <ion-grid>
          <ion-row>
            <ion-col *ngFor="let incident of incidentRecords;let k = index" col-12 col-sm-12 col-xl-4 col-lg-6 col-md-6>


              <div class="editDivView">
                <!--<ion-card class="scale-up-center" *ngIf="checkMedicationTime(time.time,medicine.oneMedication) && !checkIfTaken(time.medicationsNotifications)">-->
                <ion-card class="scale-up-center">

                  <ion-item mode="md">

                    <ion-avatar item-start>
                      <img src="assets/imgs/profile.png" *ngIf="!incident.medicalRecord.student.profileImg">
                      <img [src]="incident.medicalRecord.student.profileImg" *ngIf="incident.medicalRecord.student.profileImg">
                    </ion-avatar>

                    <label class="studentName" text-capitalize>{{ incident.medicalRecord.student.name}}</label>
                    <label class="studentClass" text-capitalize>{{incident.medicalRecord.student.classes.grade.name+" - "+incident.medicalRecord.student.classes.name}}</label>
                    <label class="creationDate" text-capitalize>{{setStartAndEndDate(incident.medicalRecord.incident.incidentDate,'start')}}</label>


                    <div class="buttonOnImg">
                      <button ion-button class="closeInDiv" clear icon-only *ngIf="false" item-end (click)="openMenu($event)">
                        <!--<button ion-button class="closeInDiv" clear icon-only *ngIf="medicine.createdFrom == 'web'" item-end (click)="openMenu($event)">-->
                        <ion-icon style="background: #eee0;color: #000000;" name="md-more" class="buttonShape" ></ion-icon>
                      </button>
                    </div>
                  </ion-item>

                  <label class="studentMedication">{{incident.medicalRecord.incident.title}}</label>

                  <div class="buttonActionTime">
                    <button mode="ios" class="buttonTime" [id]="'timeButton'+k" ion-button block  (click)="confirmTime($event,'timeButton'+k,medicine.timeOfActiveMedication.id,checkIfTaken(medicine.timeOfActiveMedication.medicationsNotifications))">
                      See Full Incident
                    </button>
                  </div>

                  <div class="bottomSpace"></div>
                </ion-card>
              </div>



            </ion-col>
          </ion-row>
        </ion-grid>


        <!--SCROLL TO ADD MORE-->
        <ion-infinite-scroll (ionInfinite)="$event.waitFor(doInfinite())">
          <ion-infinite-scroll-content></ion-infinite-scroll-content>
        </ion-infinite-scroll>


      </ion-content>
    </ion-slide>



























    <!--CHECKUP-->
    <ion-slide style="height: 100%;width: 100%;" *ngIf="accountServ.getUserRole().viewCheckup">
      <ion-content class="contentScroll">


        <!--SCROLL TO REFRESH-->
        <ion-refresher (ionRefresh)="doRefresh($event)">
          <ion-refresher-content></ion-refresher-content>
        </ion-refresher>


        <div *ngIf="loading && checkupRecords.length < 1">
          <img class="loadingMedicalCare" src="assets/imgs/heartbeat.svg">
        </div>

        <ion-item class="fitTheView" >

        </ion-item>

        <ion-grid>
          <ion-row>
            <ion-col *ngFor="let checkup of checkupRecords;let k = index" col-12 col-sm-12 col-xl-4 col-lg-6 col-md-6>



              <div class="editDivView">
                <!--<ion-card class="scale-up-center" *ngIf="checkMedicationTime(time.time,medicine.oneMedication) && !checkIfTaken(time.medicationsNotifications)">-->
                <ion-card class="scale-up-center">

                  <ion-item mode="md">

                    <ion-avatar item-start>
                      <img src="assets/imgs/profile.png" *ngIf="!checkup.medicalRecord.student.profileImg">
                      <img [src]="checkup.medicalRecord.student.profileImg" *ngIf="checkup.medicalRecord.student.profileImg">
                    </ion-avatar>

                    <label class="studentName" text-capitalize>{{ checkup.medicalRecord.student.name}}</label>
                    <label class="studentClass" text-capitalize>{{checkup.medicalRecord.student.classes.grade.name+" - "+checkup.medicalRecord.student.classes.name}}</label>
                    <label class="creationDate" text-capitalize>{{ setStartAndEndDate(checkup.medicalRecord.checkup.checkupDate,'start')}}</label>


                    <div class="buttonOnImg">
                      <button ion-button class="closeInDiv" clear icon-only *ngIf="false" item-end (click)="openMenu($event)">
                        <!--<button ion-button class="closeInDiv" clear icon-only *ngIf="medicine.createdFrom == 'web'" item-end (click)="openMenu($event)">-->
                        <ion-icon style="background: #eee0;color: #000000;" name="md-more" class="buttonShape" ></ion-icon>
                      </button>
                    </div>
                  </ion-item>

                  <label class="studentMedication">{{checkup.medicalRecord.checkup.title}}</label>

                  <div class="buttonActionTime">
                    <button mode="ios" class="buttonTime" [id]="'timeButton'+k" ion-button block  (click)="confirmTime($event,'timeButton'+k,medicine.timeOfActiveMedication.id,checkIfTaken(medicine.timeOfActiveMedication.medicationsNotifications))">
                      See Full Checkup
                    </button>
                  </div>

                  <div class="bottomSpace"></div>
                </ion-card>
              </div>




            </ion-col>
          </ion-row>
        </ion-grid>


        <!--SCROLL TO ADD MORE-->
        <ion-infinite-scroll (ionInfinite)="$event.waitFor(doInfinite())">
          <ion-infinite-scroll-content></ion-infinite-scroll-content>
        </ion-infinite-scroll>


      </ion-content>
    </ion-slide>



































    <!--APPROVAL-->
    <ion-slide style="height: 100%;width: 100%;" *ngIf="accountServ.getUserRole().medicalRecordCanApprove">
      <ion-content class="contentScroll">


        <!--SCROLL TO REFRESH-->
        <ion-refresher (ionRefresh)="doRefresh($event)">
          <ion-refresher-content></ion-refresher-content>
        </ion-refresher>


        <div *ngIf="loading && approvalRecords.length < 1">
          <img class="loadingMedicalCare" src="assets/imgs/heartbeat.svg">
        </div>

        <ion-item class="fitTheView" >

        </ion-item>

        <ion-grid>
          <ion-row>
            <ion-col *ngFor="let approval of approvalRecords;let k = index" col-12 col-sm-12 col-xl-4 col-lg-6 col-md-6>




              <div class="editDivView">
                <!--<ion-card class="scale-up-center" *ngIf="checkMedicationTime(time.time,medicine.oneMedication) && !checkIfTaken(time.medicationsNotifications)">-->
                <ion-card class="scale-up-center">

                  <ion-item mode="md">

                    <ion-avatar item-start>
                      <img src="assets/imgs/profile.png" *ngIf="!approval.medicalRecord.student.profileImg">
                      <img [src]="approval.medicalRecord.student.profileImg" *ngIf="approval.medicalRecord.student.profileImg">
                    </ion-avatar>

                    <label class="studentName" text-capitalize>{{ approval.medicalRecord.student.name}}</label>
                    <label class="studentClass" text-capitalize>{{approval.medicalRecord.student.classes.grade.name+" - "+approval.medicalRecord.student.classes.name}}</label>
                    <label class="creationDate" text-capitalize>{{ getDateForApproval(approval.medicalRecord)}}</label>


                    <div class="buttonOnImg">
                      <button ion-button class="closeInDiv" clear icon-only *ngIf="false" item-end (click)="openMenu($event)">
                        <!--<button ion-button class="closeInDiv" clear icon-only *ngIf="medicine.createdFrom == 'web'" item-end (click)="openMenu($event)">-->
                        <ion-icon style="background: #eee0;color: #000000;" name="md-more" class="buttonShape" ></ion-icon>
                      </button>
                    </div>
                  </ion-item>


                  <div class="buttonActionTime">
                    <button mode="ios" class="buttonApprove" [id]="'timeButton'+k" ion-button block  (click)="confirmTime($event,'timeButton'+k,medicine.timeOfActiveMedication.id,checkIfTaken(medicine.timeOfActiveMedication.medicationsNotifications))">
                      Approve Now
                    </button>
                  </div>

                  <div class="bottomSpace"></div>
                </ion-card>
              </div>




            </ion-col>
          </ion-row>
        </ion-grid>


        <!--SCROLL TO ADD MORE-->
        <ion-infinite-scroll (ionInfinite)="$event.waitFor(doInfinite())">
          <ion-infinite-scroll-content></ion-infinite-scroll-content>
        </ion-infinite-scroll>


      </ion-content>
    </ion-slide>

  </ion-slides>
</ion-content>

<ion-fab bottom right #fab>

  <!--<button ion-fab [disabled]="loading && medicalRecords.length < 1" ><ion-icon name="add"></ion-icon></button>-->
  <button ion-fab ><ion-icon name="add"></ion-icon></button>
  <ion-fab-list side="top" *ngIf="accountServ.getUserRole().createIncident">
    <button class="forSave" ion-fab style="padding: 0;background-color: white" (click)="fabSelected(0,fab)">
      <img src="assets/icon/firstAid.png">
      <ion-label>Incident</ion-label>
    </button>
  </ion-fab-list>


  <ion-fab-list side="left" *ngIf="accountServ.getUserRole().createCheckup">
    <button ion-fab style="padding: 0;background-color: white" (click)="fabSelected(1,fab)">
      <img src="assets/icon/mc.png">
      <ion-label>Checkup</ion-label>
    </button>
  </ion-fab-list>

</ion-fab>
